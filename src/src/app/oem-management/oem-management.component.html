<div style="margin-left:1%; margin-right: 1%;">
    <div class="row">
        <div class="col-md-6">
            <a onclick="goBack()"><i class="fas fa-chevron-left"></i></a> <span class="page-heading"> OEM Report
            </span>
        </div>
        <div class="col-md-6 banner-sec m-mb-1  mob-date dashdate">
            <div ng-app ng-controller="Ctrl" style="text-align: right;">
                <b style="margin-bottom: 0px;">
                    {{date | date:'dd.MM.yyyy'}}
                </b>
            </div>
            <div style="text-align: right;">
                {{date | date:'EEEE'}}
            </div>
        </div>
    </div>

    <div class="card mt-2">
        <div class="row" style="padding: 4px 10px;">
            <div class="col-md-4 m-mb-1">
                <div class="input-group-icon input-group-icon-left mr-3">
                    <form class="form-inline">
                        <i class="fas fa-search" aria-hidden="true"></i>
                        <input class="form-control form-control-sm ml-3 w-87" id="key-search" type="text"
                            [(ngModel)]="searchText" name="search" autocomplete="off" placeholder="Search"
                            style="background-color: #d9d9d9; ">
                    </form>
                </div>
            </div>
            <div class="col-md-6">
                <form class="form-inline" [formGroup]="form2" (ngSubmit)="dateWiseFilter()" style="float: right;">
                    <label class="mob-footer-hide">From</label> &nbsp;
                    <input type="date" [ngModel]="startDate | date:'yyyy-MM-dd'" max="{{startDate}}" formControlName="startDate" class="form-control m-w-35" style="padding: 0px 10px; margin-right: 15px; height: 30px;">
                    <label>To</label> &nbsp;
                    <input type="date" [ngModel]="endDate | date:'yyyy-MM-dd'" min="{{endDate}}" formControlName="endDate" class="form-control m-w-35" placeholder="Tosasasasas" style="padding: 0px 10px; margin-right: 10px; height: 30px;">
                    <button class="btn btn-primary" type="button" type="submit"
                        style="padding: 3px 7px; float: right; border: none;">GO!</button>
        
                </form>
            </div>
            <div class="col-md-2">
                <button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-success"
                    style="padding: 2px 10px; float: right;"> Add Campaign </button>
            </div>
        </div>

        <div class="tableFixHead">
            <table class="table table-striped table-bordered table-hover">
                <thead class="thead-dark" style="position: sticky;">
                    <tr>

                        <th style="width: 5%;" rowspan="2">#</th>
                        <th style="width: 30%;" rowspan="2">Title</th>
                        <th rowspan="2">Launch Date</th>
                        <th colspan="5" style="text-align: center;">Customer Response (Count)</th>
                    </tr>
                    <tr>
                        <th>Delivered</th>
                        <th>Read</th>
                        <th>Interested</th>
                        <th>Not Interested</th>
                        <th>Call Back</th>
                    </tr>
                </thead>
                <tbody>
                    <tr
                        *ngFor="let oem of oemListData | filter:searchText | paginate : {itemsPerPage : itemsPerPage, currentPage : p} let i = index">
                        <td style="width: 5%;">{{itemsPerPage*(p-1)+i+1}}</td>
                        <td style="width: 30%;"> <a data-toggle="modal" data-target="#exampleModal3" (click)="getDetails(oem)" class="text-primary">{{oem.title}}
                            </a>
                        </td>
                        <td>{{oem.createdAt | date:'dd-MM-yyyy'}}</td>
                        <td><a (click)="detailPage('delivered', oem.deliveredData)">{{oem.deliveredData.length}} </a></td>
                        <td><a (click)="detailPage('read', oem.readData)">{{oem.readData.length}}</a></td>
                        <td><a (click)="detailPage('interested', oem.interestedData)">{{oem.interestedData.length}}</a></td>
                        <td><a (click)="detailPage('notinterested', oem.notInterestedData)">{{oem.notInterestedData.length}}</a></td>
                        <td><a (click)="detailPage('callback', oem.callBackData)">{{oem.callBackData.length}}</a></td>
                    </tr>

                    <tr *ngIf="oemListData.message == 'No data found' ">
                        <td colspan="8" class="text-center">
                            No data found
                        </td>
                    </tr>

                    <tr *ngIf="!oemListData">
                        <td colspan="8" class="text-center">
                            <span class="spinner-border spinner-border-lg align-center"></span>
                        </td>
                    </tr>

                    <!-- <tr *ngIf="fuelList == '' ">
                        <td colspan="8" class="text-center">
                            *No data found in the given filter.
                        </td>
                    </tr> -->
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 mt-2">
            <div class="input-group-icon input-group-icon-left text-center ">
                <pagination-controls (pageChange)="p = $event"></pagination-controls>
            </div>
        </div>
    </div>
</div>

<!-- Last Location -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create Campaign</h5>
                <button type="button" #closeButton class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form [formGroup]="form" (ngSubmit)="onSubmit()" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Select Type</label>
                            <select class="form-control" formControlName="type" class="form-control" (click)="getType()"
                                required>
                                <option value="text">Text</option>
                                <option value="image">Image</option>
                                <option value="video">Video</option>
                            </select>
                        </div>
                    </div>

                    <div class="row" *ngIf="text == true">
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Campaign Title</label>
                            <input type="text" formControlName="title" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Validity Date</label>
                            <input type="date" formControlName="validityDate" class="form-control" required>
                        </div>

                        <div class="col-md-12">
                            <label><span class="required-asterisk">*</span>Text</label>
                            <textarea class="form-control" formControlName="description" cols="5" rows="4" required></textarea>
                        </div>
                        <div class="col-md-12 mt-3">
                            <h6>Target Audience</h6>
                            <hr class="mt-0 mb-1">
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Audience Type</label>
                            <select class="form-control" formControlName="audienceType" class="form-control" required>
                                <option value="ALL">ALL</option>
                                <option value="DEALERS">DEALERS</option>
                                <option value="CUSTOMERS">CUSTOMERS</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Zone</label><br>
                            <select class="form-control" formControlName="userZone" class="form-control"
                                (click)="getSubZone()" [ngClass]="{ 'is-invalid': submitted && f.userZone.errors }">
                                <option value="ALL">ALL</option>
                                <option *ngFor="let zon of zone">{{zon.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userZone.errors" class="invalid-feedback">
                                <div *ngIf="f.userZone.errors.required">Zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>Sub Zone</label><br>
                            <select class="form-control" formControlName="userSubzone" class="form-control"
                                (click)="getState()" [ngClass]="{ 'is-invalid': submitted && f.userSubzone.errors }">
                                <option></option>
                                <option *ngFor="let sub of subzone">{{sub.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userSubzone.errors" class="invalid-feedback">
                                <div *ngIf="f.userSubzone.errors.required">Sub zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>State</label><br>
                            <select class="form-control" formControlName="userState" class="form-control"
                                [ngClass]="{ 'is-invalid': submitted && f.userState.errors }">
                                <option></option>
                                <option *ngFor="let state of states">{{state.name}}</option>
                            </select>
                            <div *ngIf="submitted && f.deviceModel.errors" class="invalid-feedback">
                                <div *ngIf="f.userState.errors.required">State is required</div>
                            </div>
                        </div>
                    </div>


                    <div class="row" *ngIf="image == true">
                        <div class="col-md-4">
                            <label><span class="required-asterisk">*</span>Campaign Title</label>
                            <input type="text" formControlName="title" class="form-control" required>
                        </div>
                        <div class="col-md-4">
                            <label><span class="required-asterisk">*</span>Validity Date</label>
                            <input type="date" formControlName="validityDate" class="form-control" required>
                        </div>
                        <div class="col-md-4">
                            <label><span class="required-asterisk">*</span>Upload (jpeg or pdf)</label>
                            <input type="file" multiple formControlName="image_1" class="form-control"
                                (change)=onFileSelect1($event) required>
                        </div>
                        <div class="col-md-12">
                            <label><span class="required-asterisk">*</span>Text</label>
                            <textarea class="form-control" formControlName="description" cols="5" rows="4" required></textarea>
                        </div>
                        <div class="col-md-12 mt-3">
                            <h6>Target Audience</h6>
                            <hr class="mt-0 mb-1">
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Audience Type</label>
                            <select class="form-control" formControlName="audienceType" class="form-control" required>
                                <option value="ALL">ALL</option>
                                <option value="DEALERS">DEALERS</option>
                                <option value="CUSTOMERS">CUSTOMERS</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Zone</label><br>
                            <select class="form-control" formControlName="userZone" class="form-control"
                                (click)="getSubZone()" [ngClass]="{ 'is-invalid': submitted && f.userZone.errors }" required>
                                <option value="ALL">ALL</option>
                                <option *ngFor="let zon of zone">{{zon.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userZone.errors" class="invalid-feedback">
                                <div *ngIf="f.userZone.errors.required">Zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>Sub Zone</label><br>
                            <select class="form-control" formControlName="userSubzone" class="form-control"
                                (click)="getState()" [ngClass]="{ 'is-invalid': submitted && f.userSubzone.errors }">
                                <option></option>
                                <option *ngFor="let sub of subzone">{{sub.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userSubzone.errors" class="invalid-feedback">
                                <div *ngIf="f.userSubzone.errors.required">Sub zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>State</label><br>
                            <select class="form-control" formControlName="userState" class="form-control"
                                [ngClass]="{ 'is-invalid': submitted && f.userState.errors }">
                                <option></option>
                                <option *ngFor="let state of states">{{state.name}}</option>
                            </select>
                            <div *ngIf="submitted && f.deviceModel.errors" class="invalid-feedback">
                                <div *ngIf="f.userState.errors.required">State is required</div>
                            </div>
                        </div>
                    </div>

                    <div class="row" *ngIf="video == true">
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Campaign Title</label>
                            <input type="text" formControlName="title" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Validity Date</label>
                            <input type="date" formControlName="validityDate" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Subject</label>
                            <input type="text" formControlName="videoSubject" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Youtube Video ID</label>
                            <input type="text" formControlName="videoYoutubelink" class="form-control" required>
                        </div>
                        <div class="col-md-12 mt-3">
                            <h6>Target Audience</h6>
                            <hr class="mt-0 mb-1">
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Audience Type</label>
                            <select class="form-control" formControlName="audienceType" class="form-control" required>
                                <option value="ALL">ALL</option>
                                <option value="DEALERS">DEALERS</option>
                                <option value="CUSTOMERS">CUSTOMERS</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label><span class="required-asterisk">*</span>Zone</label><br>
                            <select class="form-control" formControlName="userZone" class="form-control"
                                (click)="getSubZone()" [ngClass]="{ 'is-invalid': submitted && f.userZone.errors }">
                                <option value="ALL">ALL</option>
                                <option *ngFor="let zon of zone">{{zon.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userZone.errors" class="invalid-feedback">
                                <div *ngIf="f.userZone.errors.required">Zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>Sub Zone</label><br>
                            <select class="form-control" formControlName="userSubzone" class="form-control"
                                (click)="getState()" [ngClass]="{ 'is-invalid': submitted && f.userSubzone.errors }">
                                <option></option>
                                <option *ngFor="let sub of subzone">{{sub.code}}</option>
                            </select>
                            <div *ngIf="submitted && f.userSubzone.errors" class="invalid-feedback">
                                <div *ngIf="f.userSubzone.errors.required">Sub zone is required</div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label>State</label><br>
                            <select class="form-control" formControlName="userState" class="form-control"
                                [ngClass]="{ 'is-invalid': submitted && f.userState.errors }">
                                <option></option>
                                <option *ngFor="let state of states">{{state.name}}</option>
                            </select>
                            <div *ngIf="submitted && f.deviceModel.errors" class="invalid-feedback">
                                <div *ngIf="f.userState.errors.required">State is required</div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mt-2" style="text-align: center;">
                        <button [disabled]="loading" class="btn btn-primary">
                            <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
                            Submit
                        </button>&nbsp;
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Campaign detail Start-->
<div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="width: 60%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Campaign Detail</h5>
                <button type="button" class="stop-video close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form [formGroup]="form">
                    <!-- <app-add></app-add>  add.component.ts -->
                    <table class="table table-striped table-bordered table-hover" style="margin-top: 10px; ">
                        <tbody style="height: auto;">
                            <div *ngIf="dType == 'text'">
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Title:
                                    </td>
                                    <td>
                                        {{ dTitle }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Create Date:
                                    </td>
                                    <td>
                                        {{ dCreatedAt | date:'dd-MM-yyyy' }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Validity Date
                                    </td>
                                    <td>
                                        {{ dValidyDate | date:'dd-MM-yyyy' }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Created By:
                                    </td>
                                    <td>
                                        {{ dCreatedBy }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Zone
                                    </td>
                                    <td *ngIf = "dZone == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dZone != ''">
                                        {{ dZone }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        State
                                    </td>
                                    <td *ngIf = "dState == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dState != ''">
                                        {{ dState }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold; text-align: right;">
                                        Description
                                    </td>
                                    <td>
                                        {{ dDescription }}
                                    </td>
                                    <td style="font-weight: bold; text-align: right;">
                                        Type
                                    </td>
                                    <td>
                                        {{ dType }}
                                    </td>
                                </tr>
                            </div>

                            <div *ngIf="dType == 'video'">
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Title:
                                    </td>
                                    <td>
                                        {{ dTitle }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Create Date:
                                    </td>
                                    <td>
                                        {{ dCreatedAt | date:'dd-MM-yyyy' }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Validity Date
                                    </td>
                                    <td>
                                        {{ dValidyDate | date:'dd-MM-yyyy'}}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Created By:
                                    </td>
                                    <td>
                                        {{ dCreatedBy }}
                                    </td>

                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Zone
                                    </td>
                                    <td *ngIf = "dZone == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dZone != ''">
                                        {{ dZone }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        State
                                    </td>
                                    <td *ngIf = "dState == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dState != ''">
                                        {{ dState }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold; text-align: right;">
                                        Video Link
                                    </td>
                                    <td>
                                        {{ dVideoLink }}
                                        
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Type
                                    </td>
                                    <td>
                                        {{ dType }}
                                    </td>
                                </tr>
                                <tr style="text-align:center">
                                    <iframe width="100%" height="315" [src]="safeSrc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </tr>
                            </div>

                            <div *ngIf="dType == 'image'">
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Title:
                                    </td>
                                    <td>
                                        {{ dTitle }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Create Date:
                                    </td>
                                    <td>
                                        {{ dCreatedAt | date:'dd-MM-yyyy' }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Validity Date
                                    </td>
                                    <td>
                                        {{ dValidyDate | date:'dd-MM-yyyy' }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Created By:
                                    </td>
                                    <td>
                                        {{ dCreatedBy }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Zone
                                    </td>
                                    <td *ngIf = "dZone == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dZone != ''">
                                        {{ dZone }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        State
                                    </td>
                                    <td *ngIf = "dState == ''">
                                        ALL
                                    </td>
                                    <td *ngIf = "dState != ''">
                                        {{ dState }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;text-align: right;">
                                        Description
                                    </td>
                                    <td>
                                        {{ dDescription }}
                                    </td>
                                    <td style="font-weight: bold;text-align: right;">
                                        Type
                                    </td>
                                    <td>
                                        {{ dType }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <a href="{{ dImages[0] }}" target="_blank"><img src="{{ dImages[0] }}"
                                                alt="images" height="100" width="100"></a>
                                    </td>
                                    <td>
                                        <a href="{{ dImages[1] }}" target="_blank"><img src="{{ dImages[1] }}"
                                                alt="images" height="100" width="100"></a>
                                    </td>
                                    <td>
                                        <a href="{{ dImages[2] }}" target="_blank"><img src="{{ dImages[2] }}"
                                                alt="images" height="100" width="100"></a>
                                    </td>
                                </tr>
                            </div>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Campaign detail End-->

<script>
    $('button.stop-video').click(function(){
	$('.youtube-video')[0].contentWindow.postMessage('{"event":"command","func":"' + 'stopVideo' + '","args":""}', '*');
});
</script>